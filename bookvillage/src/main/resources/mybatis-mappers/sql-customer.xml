<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mi.bookvillage.customer.model.dao.CustomerDAO">

    <select id="getCustomerList" resultType="CustomerVO">
        SELECT USER_SEQ
             , USER_NAME
             , USER_ID
             , USER_PW
             , USER_BIRTH
             , USER_TELL
             , DATE_FORMAT(USER_REG_DT, '%Y-%m-%d %H:%i') AS USER_REG_DT
             , DATE_FORMAT(USER_UPDATE_DT, '%Y-%m-%d %H:%i') AS USER_UPDATE_DT
             , USER_ROLE
          FROM CUSTOMER
    </select>


    <select id="loginCustomer" resultType="CustomerVO">
        SELECT USER_ID ,
               USER_PW ,
               USER_NAME,
               USER_BIRTH,
               USER_TELL,
               USER_REG_DT,
               USER_ROLE
          FROM CUSTOMER
         WHERE USER_ID = #{userId}
    </select>


    <insert id="addCustomer">
        INSERT INTO CUSTOMER (
                              USER_ID ,
                              USER_PW ,
                              USER_NAME,
                              USER_BIRTH,
                              USER_TELL
                             )
                    VALUES (
                            #{userId},
                            #{userPw},
                            #{userName},
                            #{userBirth},
                            #{userTell}
                           )
    </insert>


    <select id="getCustomerBySeq" resultType="CustomerVO">
        SELECT C.USER_SEQ AS USER_SEQ,
               C.USER_ID AS USER_ID,
               C.USER_PW AS USER_PW,
               C.USER_NAME AS USER_NAME,
               C.USER_BIRTH AS USER_BIRTH,
               C.USER_TELL AS USER_TELL,
               C.USER_REG_DT AS USER_REG_DT,
               C.USER_ROLE AS USER_ROLE,
               P.TOTAL_POINT AS USER_POINT
         FROM CUSTOMER C
         JOIN (
                 SELECT USER_SEQ,
                        TOTAL_POINT
                   FROM POINT P
                  WHERE USER_SEQ = #{userSeq}
               ) P
           ON C.USER_SEQ = P.USER_SEQ

    </select>


    <select id="getCustomerById" resultType="CustomerVO">
        SELECT USER_SEQ AS USER_SEQ,
               USER_ID AS USER_ID,
               USER_PW AS USER_PW,
               USER_NAME AS USER_NAME,
               USER_BIRTH AS USER_BIRTH,
               USER_TELL AS USER_TELL,
               USER_REG_DT AS USER_REG_DT,
               USER_ROLE AS USER_ROLE
        FROM CUSTOMER
         WHERE USER_ID = #{userId}
    </select>


    <update id="updateCustomer">
        UPDATE CUSTOMER
            SET USER_ID = #{userId},
                USER_PW = #{userPw},
                USER_NAME = #{userName},
                USER_BIRTH = #{userBirth},
                USER_TELL = #{userTell}
         WHERE USER_SEQ = #{userSeq}
    </update>


    <delete id="deleteCustomer">
        DELETE
          FROM CUSTOMER
         WHERE USER_SEQ = #{userSeq}
    </delete>







    
</mapper>